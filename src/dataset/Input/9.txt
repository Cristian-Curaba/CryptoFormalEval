# Protocol 9

### Knowledge

A : A, B, S, pkA, skA
B : A, B, S, pkS
S : A, B, S, skS, pkS, pkA
where pkA, pkS are public, asymmetric keys; skA, SkS are secret asymmetric keys.

### Actions

A → S : aenc((A, pkA), skA)
B → S : aenc((A, Key), pkS)
S → B : senc(pkA, Key)
B → A : aenc(M, pkA)
Key, M are freshly generated by B

### Property

Secrecy of M
lemma secrecy:
"All x #i.
Secret(x) @i ==> not (Ex #j. K(x)@j)"