# Protocol 3

### Knowledge

A: A, B, pkB, M
B: A, B, pkB, prB

where pkB is the public key of B, prB is the private one.

### Actions

A → B : A, senc((A, M), Key)
B → A : N
A → B : aenc((N, Key), pkB)

where Key is a freshly generated key by A, N is freshly generated by B.

### Property

Authenticity of N
lemma message_authentication:
    "All b m #i. Authentic(b,m) @i
    ==> (Ex #j. Send(b,m) @j & j<i)"